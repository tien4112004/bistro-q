<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="BistroQ.Presentation.Views.AdminDashboard.AdminDashboardPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:converters="using:BistroQ.Presentation.Converters"
    xmlns:lvc="using:LiveChartsCore.SkiaSharpView.WinUI"
    mc:Ignorable="d">

    <Page.Resources>
        <converters:NumberToCurrencyConverter x:Key="NumberToCurreny"/>
        <converters:AxisConverter x:Key="AxisConverter"/>
    </Page.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Main Content -->
        <ScrollViewer Grid.Row="1">
            <Grid Padding="20">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" MinWidth="300"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Left Column - Stats Cards -->
                <StackPanel Grid.Column="0" Spacing="16" Width="300">
                    <!-- Revenue Card -->
                    <Grid Background="{ThemeResource CardBackgroundFillColorDefault}" 
                          Padding="16" CornerRadius="8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <FontIcon Grid.Column="0" Glyph="&#xE8FB;" 
                                 Foreground="{ThemeResource SystemAccentColor}"
                                 FontSize="24" Margin="0,0,12,0"/>

                        <StackPanel Grid.Column="1">
                            <TextBlock Text="Today's Revenue" 
                                     Style="{StaticResource CaptionTextBlockStyle}"
                                     Foreground="{ThemeResource TextFillColorSecondary}"/>
                            <TextBlock Text="{x:Bind ViewModel.TodayRevenue, Mode=OneWay, Converter={StaticResource NumberToCurreny}}"
                                     Style="{StaticResource SubtitleTextBlockStyle}"/>
                        </StackPanel>
                    </Grid>

                    <!-- Customer Traffic Card -->
                    <Grid Background="{ThemeResource CardBackgroundFillColorDefault}" 
                          Padding="16" CornerRadius="8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <FontIcon Grid.Column="0" Glyph="&#xE716;" 
                                 Foreground="{ThemeResource SuccessBaseColor}"
                                 FontSize="24" Margin="0,0,12,0"/>

                        <StackPanel Grid.Column="1">
                            <TextBlock Text="Total Customers Today" 
                                     Style="{StaticResource CaptionTextBlockStyle}"
                                     Foreground="{ThemeResource TextFillColorSecondary}"/>
                            <TextBlock Text="{x:Bind ViewModel.CustomerCount, Mode=OneWay}"
                                     Style="{StaticResource SubtitleTextBlockStyle}"/>
                        </StackPanel>
                    </Grid>

                    <!-- Average Order Time Card -->
                    <Grid Background="{ThemeResource CardBackgroundFillColorDefault}" 
                          Padding="16" CornerRadius="8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <FontIcon Grid.Column="0" Glyph="&#xE823;" 
                                 Foreground="{ThemeResource WarningBaseColor}"
                                 FontSize="24" Margin="0,0,12,0"/>

                        <StackPanel Grid.Column="1">
                            <TextBlock Text="Avg. Order Time" 
                                     Style="{StaticResource CaptionTextBlockStyle}"
                                     Foreground="{ThemeResource TextFillColorSecondary}"/>
                            <TextBlock>
                                <Run Text="{x:Bind ViewModel.AverageOrderTime, Mode=OneWay}"/>
                                <Run Text="min"/>
                            </TextBlock>
                        </StackPanel>
                    </Grid>

                    <!-- NEW: Table Turnover Rate -->
                    <Grid Background="{ThemeResource CardBackgroundFillColorDefault}" 
                          Padding="16" CornerRadius="8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <FontIcon Grid.Column="0" Glyph="&#xE8C0;" 
                                 Foreground="{ThemeResource SystemAccentColor}"
                                 FontSize="24" Margin="0,0,12,0"/>

                        <StackPanel Grid.Column="1">
                            <TextBlock Text="Table Turnover Rate" 
                                     Style="{StaticResource CaptionTextBlockStyle}"
                                     Foreground="{ThemeResource TextFillColorSecondary}"/>
                            <TextBlock>
                                <Run Text="{x:Bind ViewModel.TableTurnoverRate, Mode=OneWay}"/>
                                <Run Text="per day"/>
                            </TextBlock>
                        </StackPanel>
                    </Grid>

                    <!-- NEW: Popular Category -->
                    <Grid Background="{ThemeResource CardBackgroundFillColorDefault}" 
                          Padding="16" CornerRadius="8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <FontIcon Grid.Column="0" Glyph="&#xE8EC;" 
                                 Foreground="{ThemeResource SuccessBaseColor}"
                                 FontSize="24" Margin="0,0,12,0"/>

                        <StackPanel Grid.Column="1">
                            <TextBlock Text="Most Popular Category" 
                                     Style="{StaticResource CaptionTextBlockStyle}"
                                     Foreground="{ThemeResource TextFillColorSecondary}"/>
                            <TextBlock Text="{x:Bind ViewModel.PopularCategory, Mode=OneWay}"
                                     Style="{StaticResource SubtitleTextBlockStyle}"/>
                        </StackPanel>
                    </Grid>

                    <!-- NEW: Average Calories -->
                    <Grid Background="{ThemeResource CardBackgroundFillColorDefault}" 
                          Padding="16" CornerRadius="8">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="Auto"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <FontIcon Grid.Column="0" Glyph="&#xE9D9;" 
                                 Foreground="{ThemeResource WarningBaseColor}"
                                 FontSize="24" Margin="0,0,12,0"/>

                        <StackPanel Grid.Column="1">
                            <TextBlock Text="Avg. Calories per Order" 
                                     Style="{StaticResource CaptionTextBlockStyle}"
                                     Foreground="{ThemeResource TextFillColorSecondary}"/>
                            <TextBlock>
                                <Run Text="{x:Bind ViewModel.AverageCaloriesPerOrder, Mode=OneWay}"/>
                                <Run Text="kcal"/>
                            </TextBlock>
                        </StackPanel>
                    </Grid>
                </StackPanel>

                <!-- Right Column - Charts -->
                <Grid Grid.Column="1" Margin="20,0,0,0">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Revenue Trend Chart -->
                    <Grid Grid.Row="0" Background="{ThemeResource CardBackgroundFillColorDefault}" 
                          Padding="16" CornerRadius="8" Margin="0,0,0,10">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <TextBlock Text="Revenue Trend" 
                                 Style="{StaticResource SubtitleTextBlockStyle}"
                                 Margin="0,0,0,16"/>

                        <lvc:CartesianChart 
                            Grid.Row="1"             
                            Series="{x:Bind ViewModel.RevenueSeries}"
                            XAxes="{x:Bind ViewModel.RevenueXAxes, Converter={StaticResource AxisConverter}}"
                            YAxes="{x:Bind ViewModel.RevenueYAxes, Converter={StaticResource AxisConverter}}"
                            Background="Transparent"/>
                    </Grid>

                    <!-- Popular Dishes Chart -->
                    <Grid Grid.Row="1" Background="{ThemeResource CardBackgroundFillColorDefault}" 
                          Padding="16" CornerRadius="8" Margin="0,10,0,0">
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <TextBlock Text="Popular Dishes" 
                                 Style="{StaticResource SubtitleTextBlockStyle}"
                                 Margin="0,0,0,16"/>

                        <lvc:CartesianChart Grid.Row="1"
                            Series="{x:Bind ViewModel.PopularDishesSeries}"
                            XAxes="{x:Bind ViewModel.PopularDishesXAxes, Converter={StaticResource AxisConverter}}"
                            YAxes="{x:Bind ViewModel.PopularDishesYAxes, Converter={StaticResource AxisConverter}}"
                            Background="Transparent"/>
                    </Grid>
                </Grid>
            </Grid>
        </ScrollViewer>
    </Grid>
</Page>